<div class="d-flex flex-column">
    <h3>Bienvenido {{nombreUsuario}}</h3>
    <button mat-flat-button (click)="logOut()" >Cerrar Sesión</button>
</div>

<div class="my-4">
    <mat-tab-group>
        <mat-tab label="Reservaciones">
        @if (reserv != null) {
        <table class="table table-striped-columns table-hover">
            <thead>
                <tr>
                <th scope="col">#</th>
                <th scope="col">Nombre</th>
                <th scope="col">Habitación</th>
                <th scope="col">Noches</th>
                <th scope="col">Personas</th>
                <th scope="col">Fecha</th>
                <th scope="col">Extras</th>
                <th scope="col">Acciones</th>
                </tr>
            </thead>
            <tbody>
                @for (r of reserv; track r; let i = $index) {
                <tr>
                    <td>{{i+1}}</td>
                    <td>
                    @if ((editNum != i)) {
                        {{r.nombre}}
                    }@else {
                        <input type="text" [(ngModel)]="editAux.nombre">
                    }
                    </td>
                    <td>
                    @if ((editNum != i)) {
                        {{r.tipo}}
                    }@else {
                        <select [(ngModel)]="editAux.tipo" name="tipo" #tipo="ngModel">
                            @for (hab of habitaciones; track hab.tipo) {
                            <option [value]="hab.tipo">{{hab.tipo}}</option>
                            }
                        </select>
                    }
                    </td>
                    <td>
                    @if ((editNum != i)) {
                        {{r.noches}}
                    }@else {
                        <input type="number" [(ngModel)]="editAux.noches">
                    }
                    </td>
                    <td>
                    @if ((editNum != i)) {
                        {{r.personas}}
                    }@else {
                        <input type="number" [(ngModel)]="editAux.personas">
                    }
                    </td>
                    <td>
                    @if ((editNum != i)) {
                        {{r.fecha}}
                    }@else {
                        <input type="date" [(ngModel)]="editAux.fecha">
                    }
                    </td>
                    <td>
                    @if ((editNum != i)) {
                        @if (r.extras['Desayuno']) {
                            <p>Desayuno</p>
                        }
                        @if (r.extras['Acceso al spa']) {
                            <p>Acceso al Spa</p>
                        }
                        @if (r.extras['Estacionamiento privado']) {
                            <p>Estacionamiento privado</p>
                        }
                        @if (r.extras['Transporte al aeropuerto']) {
                            <p>Transporte al aeropuerto</p>
                        }
                        @if (r.extras['Cena romántica']) {
                            <p>Cena romántica</p>
                        }
                    }@else {
                        <label>
                            <input type="checkbox" id="Desayuno + {{i}}" [(ngModel)]="editAux.extras['Desayuno']">
                            <span class="ms-2">Desayuno</span>
                        </label>
                        <label>
                            <input type="checkbox" id="Desayuno + {{i}}" [(ngModel)]="editAux.extras['Acceso al spa']">
                            <span class="ms-2">Acceso al spa</span>
                        </label>
                        <label>
                            <input type="checkbox" id="Desayuno + {{i}}" [(ngModel)]="editAux.extras['Estacionamiento privado']">
                            <span class="ms-2">Estacionamiento privado</span>
                        </label>
                        <label>
                            <input type="checkbox" id="Desayuno + {{i}}" [(ngModel)]="editAux.extras['Transporte al aeropuerto']">
                            <span class="ms-2">Transporte al aeropuerto</span>
                        </label>
                        <label>
                            <input type="checkbox" id="Desayuno + {{i}}" [(ngModel)]="editAux.extras['Cena romántica']">
                            <span class="ms-2">Cena romántica</span>
                        </label>
                    }
                    </td>
                    <td>
                        <div class="d-flex flex-row justify-content-around">
                            @if (editNum !== i) {
                            <button mat-mini-fab aria-label="Edit Button" (click)="editReserv(i,0)">
                                <mat-icon>create</mat-icon>
                            </button>
                            }@else {
                            <button mat-mini-fab aria-label="Save Button" (click)="saveReserv(i,0)">
                                <mat-icon>save</mat-icon>
                            </button>
                            <button mat-mini-fab aria-label="Cencel Button" (click)="cancelReserv()">
                                <mat-icon>cancel</mat-icon>
                            </button>
                            }
                            <button mat-mini-fab aria-label="Delete Button" (click)="deleteReserv(i,0)">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </div>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        }@else {
        <p class="text-center mt-5 text-bold display-6">No hay información disponible de las reservaciones.</p>
        }
        </mat-tab>
        <mat-tab label="Newsletter"> 
        @if (subs != null) {
        <table class="table table-striped-columns table-hover">
            <thead>
                <tr>
                <th scope="col">#</th>
                <th scope="col">Nombre</th>
                <th scope="col">Correo</th>
                <th scope="col">Habitación</th>
                <th scope="col">Fecha Inicio</th>
                <th scope="col">Fecha Fin</th>
                <th scope="col">Acciones</th>
                </tr>
            </thead>
            <tbody>
                @for (s of subs; track s; let i = $index) {
                <tr>
                    <td>{{i+1}}</td>
                    <td>{{s.name}}</td>
                    <td>{{s.email}}</td>
                    <td>{{s.room}}</td>
                    <td>{{s.start}}</td>
                    <td>{{s.end}}</td>
                    <td class="d-flex flex-row justify-content-around">
                        <button mat-mini-fab aria-label="Edit Button">
                            <mat-icon>create</mat-icon>
                        </button>
                        <button mat-mini-fab aria-label="Delete Button">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        }@else {
        <p class="text-center mt-5 text-bold display-6">No hay información disponible de las suscripciones a la newsletter.</p>
        }
        </mat-tab>
    </mat-tab-group>
</div>